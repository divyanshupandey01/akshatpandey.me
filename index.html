<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Akshat Pandey</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet">

<style>
/* --- CORE CSS --- */
*{margin:0;padding:0;box-sizing:border-box;font-family:'Inter',system-ui,sans-serif}

body{
  min-height:100vh;
  background:radial-gradient(circle at top,#111,#000);
  color:#fff;
  display:flex;
  justify-content:center;
  padding:20px;
}

.container{max-width:900px;width:100%;text-align:center; position: relative; z-index: 1;}

.profile-pic{
  width:160px;height:160px;border-radius:50%;
  object-fit:cover;border:4px solid #00ffcc;
  margin:20px auto 10px;
}

.socials{display:flex;justify-content:center;gap:20px;margin-bottom:20px}
.socials img{width:32px;height:32px;cursor:pointer}

h1{
  font-family:'Space Grotesk',sans-serif;
  font-size:clamp(2.5rem,8vw,4rem);
}

.views{
  display:flex;justify-content:center;gap:8px;
  align-items:center;font-size:.95rem;opacity:.75;margin-top:6px;
}

.tagline{opacity:.85;margin:12px 0 30px}

.card{
  background:rgba(255,255,255,.06);
  border-radius:18px;
  padding:26px;
  margin-bottom:26px;
  text-align:left;
}

.btn{
  display:inline-block;margin-top:14px;padding:10px 20px;
  background:#00ffcc;color:#000;border-radius:999px;
  font-weight:700;text-decoration:none;
}

.comment-box h2{margin-bottom:18px}

textarea{
  width:100%;min-height:100px;background:#000;
  border:1px solid rgba(0,255,204,.45);
  border-radius:14px;padding:14px;color:#fff;
}
textarea::placeholder{color:#fff;font-weight:600}

.comment-btn{
  margin-top:14px;padding:10px 20px;
  background:#00ffcc;color:#000;border:none;
  border-radius:999px;font-weight:700;cursor:pointer;
}

.comments{margin-top:26px}

.comment{
  background:rgba(255,255,255,.08);
  border-radius:14px;
  padding:14px 14px 18px;
  margin-bottom:14px;
  font-size:.95rem;
  position:relative;
}

.comment small{
  opacity:.7;
  display:block;
  margin-bottom:4px;
  font-family:monospace;
}

/* DELETE BUTTON */
.del{
  position:absolute; top:8px; right:8px;
  width:44px; height:44px;
  border-radius:50%;
  background:rgba(255,255,255,.18);
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; z-index:10;
}
.del:active{ transform:scale(0.92); background:rgba(255,107,107,.4); }
.del img{ width:20px; height:20px; pointer-events:none; }

footer{margin-top:30px;font-size:.9rem;opacity:.65;text-align:center}

/* --- FEATURES CSS --- */
.user-header { display: flex; align-items: center; gap: 12px; margin-bottom: 8px; }
.user-avatar { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 2px solid #00ffcc; }
.user-info { display: flex; flex-direction: column; }
.user-name { font-weight: 700; font-size: 1rem; color: #fff; }
.user-handle { font-size: 0.8rem; opacity: 0.7; color: #00ffcc; }
.admin-badge { background: #00ffcc; color: #000; font-size: 0.7rem; padding: 2px 6px; border-radius: 4px; margin-left: 6px; font-weight: 800; vertical-align: middle; }

.reply-btn { background: transparent; border: 1px solid rgba(0,255,204,0.3); color: #00ffcc; padding: 4px 12px; border-radius: 99px; font-size: 0.8rem; cursor: pointer; margin-top: 10px; }
.replies-container { margin-top: 12px; padding-left: 14px; border-left: 2px solid rgba(255,255,255,0.1); }
.reply-input-box { display: none; margin-top: 10px; animation: fadeIn 0.3s ease; }
@keyframes fadeIn{from{opacity:0;transform:translateY(-5px)}to{opacity:1;transform:translateY(0)}}

/* MODALS */
.auth-modal { 
  position: fixed; top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.85); backdrop-filter: blur(5px); 
  z-index: 9999; display: none !important;
  align-items: center; justify-content: center; 
}
.auth-modal.open { display: flex !important; }

.auth-card { background: #1a1a1a; width: 90%; max-width: 400px; padding: 24px; border-radius: 20px; border: 1px solid rgba(0,255,204,0.2); max-height: 90vh; overflow-y: auto; text-align: left; }
.auth-card h3 { margin-bottom: 16px; color: #00ffcc; text-align: center; }
.form-group { margin-bottom: 12px; text-align: left; }
.form-group label { font-size: 0.85rem; opacity: 0.8; display: block; margin-bottom: 4px; }
.form-group input { width: 100%; padding: 10px; background: #000; border: 1px solid #333; border-radius: 8px; color: #fff; }
.auth-btn { width: 100%; padding: 12px; background: #00ffcc; color: #000; font-weight: 700; border: none; border-radius: 99px; margin-top: 10px; cursor: pointer; }
.notify-trigger { background: rgba(0,255,204,0.1); border: 1px solid #00ffcc; color: #00ffcc; padding: 12px 20px; border-radius: 12px; margin-bottom: 20px; cursor: pointer; width: 100%; font-weight: 600; }
.notify-trigger:hover { background: #00ffcc; color: #000; }

.upload-wrapper { display: flex; justify-content: center; margin-bottom: 20px; }
.upload-circle { width: 90px; height: 90px; border-radius: 50%; background: #111; border: 2px dashed #00ffcc; display: flex; align-items: center; justify-content: center; cursor: pointer; overflow: hidden; position: relative; }
.upload-circle img { width: 100%; height: 100%; object-fit: cover; display: none; }
.upload-circle span { font-size: 2rem; opacity: 0.5; }
.upload-label { text-align: center; font-size: 0.8rem; color: #00ffcc; opacity: 0.8; margin-top: -15px; margin-bottom: 15px; }

.login-trigger-btn { margin-top:14px; padding:10px 20px; background: transparent; border: 1px solid #00ffcc; color: #00ffcc; border-radius:999px; font-weight:700; cursor:pointer; margin-left: 10px; }
.login-trigger-btn:hover { background: rgba(0,255,204,0.1); }
</style>
</head>

<body>
<div class="container">

<img src="https://i.postimg.cc/SKhqgHqv/IMG-20260111-212449-914.webp" class="profile-pic">

<div class="socials">
  <a href="https://instagram.com/vedicash" target="_blank"><img src="https://i.postimg.cc/GmNvBpX1/instagram.png"></a>
  <a href="mailto:akshatpandey1307@gmail.com"><img src="https://i.postimg.cc/bNwn3nMZ/gmail.png"></a>
  <a href="https://www.linkedin.com/in/akshat-pandey-5b2a552a3" target="_blank"><img src="https://i.postimg.cc/764G7J79/linkedin.png"></a>
</div>

<h1>Akshat Pandey</h1>
<div class="views">üëÅÔ∏è <span id="viewCount">loading...</span> views</div>

<div class="tagline">Personal Landing Page</div>

<div class="card">
  Nigga this my landing page running on my personal server computer 24/7.
  <br><br>
  <a href="https://naturally-partial-wrote-scout.trycloudflare.com/a80cccda/instagram" target="_blank">
    https://naturally-partial-wrote-scout.trycloudflare.com/a80cccda/instagram
  </a><br>
  <a class="btn" href="https://naturally-partial-wrote-scout.trycloudflare.com/a80cccda/instagram">Go ‚Üí</a>
</div>

<button class="notify-trigger" onclick="openNotifyModal()">
  üîî Get Notified When Akshat Replies
</button>

<div class="card comment-box">
  <div id="welcomeMsg" style="margin-bottom:10px;color:#00ffcc;font-size:0.9rem;display:none;justify-content:space-between;align-items:center;">
    <span id="userStatusText"></span>
    <button onclick="logout()" style="background:transparent;border:none;color:#ff6b6b;cursor:pointer;font-size:0.8rem;text-decoration:underline">Logout</button>
  </div>

  <h2>Drop a Comment</h2>
  <textarea id="commentInput" placeholder="Write something..."></textarea>
  
  <div style="display:flex;align-items:center;">
    <button class="comment-btn" onclick="handleMainComment()">Post Comment</button>
    <button id="loginBtn" class="login-trigger-btn" onclick="openLogin()">üîë Login</button>
  </div>

  <div class="comments" id="comments"></div>
</div>

<footer>¬© 2026 Akshat Pandey ‚Ä¢ Hosted On My Infrastructure</footer>
</div>

<div id="loginModal" class="auth-modal">
  <div class="auth-card">
    <h3>üîë Login</h3>
    <p style="font-size:0.85rem;opacity:0.7;margin-bottom:15px;text-align:center">Enter Username OR Email</p>
    <div class="form-group"><label>Username / Email</label><input id="loginInput" type="text" placeholder="@username or email"></div>
    <div class="form-group"><label>Password</label><input id="loginPass" type="password" placeholder="******"></div>
    <button class="auth-btn" onclick="submitLogin()">Login</button>
    <div style="text-align:center;margin-top:15px;font-size:0.9rem">
      New here? <span onclick="switchToSignup()" style="color:#00ffcc;cursor:pointer;text-decoration:underline">Sign Up</span>
    </div>
    <button style="background:transparent;border:none;color:#aaa;margin-top:10px;cursor:pointer;width:100%" onclick="closeModals()">Close</button>
  </div>
</div>

<div id="signupModal" class="auth-modal">
  <div class="auth-card">
    <div class="upload-wrapper">
      <div class="upload-circle" onclick="document.getElementById('hiddenFileInput').click()">
        <span id="uploadIcon">üì∑</span>
        <img id="previewImg" src="">
      </div>
      <input type="file" id="hiddenFileInput" hidden accept="image/*" onchange="handleFileSelect(event)">
    </div>
    <div class="upload-label">Tap circle to upload photo</div>
    <h3 style="margin-top:0">Create Account</h3>
    <div class="form-group"><label>Full Name</label><input id="regName" type="text" placeholder="John Doe"></div>
    <div class="form-group"><label>Username (Unique)</label><input id="regUser" type="text" placeholder="@johnny"></div>
    <div class="form-group"><label>Email</label><input id="regEmail" type="email" placeholder="john@example.com"></div>
    <div class="form-group"><label>Password</label><input id="regPass" type="password" placeholder="******"></div>
    <div class="form-group"><label>Birthday</label><input id="regDob" type="date"></div>
    <div class="form-group"><label>Instagram ID (Optional)</label><input id="regInsta" type="text" placeholder="@john.doe"></div>
    <button class="auth-btn" onclick="submitSignup()">Sign Up</button>
    <button style="background:transparent;border:none;color:#aaa;margin-top:10px;cursor:pointer;width:100%" onclick="closeModals()">Cancel</button>
  </div>
</div>

<div id="notifyModal" class="auth-modal">
  <div class="auth-card">
    <h3>üîî Get Updates</h3>
    <p style="font-size:0.9rem;opacity:0.7;margin-bottom:15px;text-align:center;">Be the first to know when Akshat replies.</p>
    <div class="form-group">
      <label>Your Name</label>
      <input id="notifyName" type="text" placeholder="Your Name">
    </div>
    <div class="form-group">
      <label>Email or Instagram Handle</label>
      <input id="notifyContact" type="text" placeholder="email@example.com or @handle">
    </div>
    <button class="auth-btn" onclick="saveNotification()">Subscribe</button>
    <button style="background:transparent;border:none;color:#aaa;margin-top:10px;cursor:pointer;width:100%" onclick="closeModals()">Close</button>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>

<script>
/* --- CONFIG & INIT --- */
const firebaseConfig = {
  apiKey: "AIzaSyCY88mD-sHqxZiOGkQZbliTXG1QmySPesI",
  authDomain: "akshat-comments.firebaseapp.com",
  projectId: "akshat-comments"
};

const app = firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// üõ°Ô∏è ADMIN CONFIGURATION
const ADMIN_USERNAME = "@scionash";
const ADMIN_PASSWORD_KEY = "@Akshat130807";
const ADMIN_PROFILE = {
  name: "Akshat Pandey",
  photo: "https://i.postimg.cc/SKhqgHqv/IMG-20260111-212449-914.webp",
  username: "@scionash",
  role: "admin",
  uid: "ADMIN_MASTER_UID"
};

/* --- VIEWS --- */
const viewCount = document.getElementById("viewCount");
const viewRef = db.collection("views").doc("counter");

function updateViews(){
  viewRef.get().then((docSnap) => {
    if (!docSnap.exists) {
      viewRef.set({count: 1}).then(() => { viewCount.textContent = "1"; });
    } else {
      viewRef.update({ count: firebase.firestore.FieldValue.increment(1) });
      viewCount.textContent = docSnap.data().count + 1; 
    }
  }).catch((error) => {
    console.log("View Error:", error);
    viewCount.textContent = "Offline Mode"; 
  });
}
updateViews();

/* --- USER STATE --- */
let currentUser = null;
let currentProfileBase64 = "https://cdn-icons-png.flaticon.com/512/847/847969.png"; 
// Cache the comments so we can re-render instantly on login
let cachedCommentsSnapshot = null; 

// Auto Login
function autoLogin() {
  const storedUid = localStorage.getItem("akshat_uid");
  
  if(storedUid === "ADMIN_MASTER_UID") {
    currentUser = ADMIN_PROFILE;
    updateUIState();
  } else if(storedUid) {
    db.collection("users").doc(storedUid).get().then((doc) => {
      if(doc.exists) {
        currentUser = { ...doc.data(), uid: doc.id };
        updateUIState();
      }
    });
  }
}
autoLogin();

function updateUIState() {
  const w = document.getElementById("welcomeMsg");
  const loginBtn = document.getElementById("loginBtn");
  const statusText = document.getElementById("userStatusText");

  if(currentUser) {
    const isAdmin = currentUser.role === "admin";
    w.style.display = "flex";
    statusText.innerHTML = `Logged in as <b>${currentUser.name}</b> ${isAdmin ? '(Admin)' : ''}`;
    loginBtn.style.display = "none";
  } else {
    w.style.display = "none";
    loginBtn.style.display = "block";
    loginBtn.innerText = "üîë Login";
  }
  // FORCE RE-RENDER OF COMMENTS (Updates delete buttons)
  if(cachedCommentsSnapshot) renderComments(cachedCommentsSnapshot);
}

/* --- IMAGE COMPRESS --- */
function compressImage(file) {
  return new Promise((resolve) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = (event) => {
      const img = new Image();
      img.src = event.target.result;
      img.onload = () => {
        const canvas = document.createElement("canvas");
        const ctx = canvas.getContext("2d");
        const MAX_SIZE = 150;
        let width = img.width;
        let height = img.height;
        if (width > height) {
          if (width > MAX_SIZE) { height *= MAX_SIZE / width; width = MAX_SIZE; }
        } else {
          if (height > MAX_SIZE) { width *= MAX_SIZE / height; height = MAX_SIZE; }
        }
        canvas.width = width;
        canvas.height = height;
        ctx.drawImage(img, 0, 0, width, height);
        resolve(canvas.toDataURL("image/jpeg", 0.7)); 
      };
    };
  });
}

/* --- GLOBAL FUNCTIONS --- */
function handleFileSelect(e) {
  if (e.target.files && e.target.files[0]) {
    compressImage(e.target.files[0]).then(base64 => {
      currentProfileBase64 = base64;
      document.getElementById('previewImg').src = base64;
      document.getElementById('previewImg').style.display = 'block';
      document.getElementById('uploadIcon').style.display = 'none';
      document.querySelector('.upload-circle').style.border = '2px solid #00ffcc';
    });
  }
}

function closeModals() {
  document.querySelectorAll('.auth-modal').forEach(m => m.classList.remove('open'));
}

function openLogin() {
  closeModals();
  document.getElementById("loginModal").classList.add('open');
}
function openSignup() {
  closeModals();
  document.getElementById("signupModal").classList.add('open');
}
function switchToSignup() {
  closeModals();
  openSignup();
}

function logout() {
  localStorage.removeItem("akshat_uid");
  currentUser = null;
  updateUIState();
}

function submitLogin() {
  const input = document.getElementById("loginInput").value.trim();
  const p = document.getElementById("loginPass").value.trim();

  if(!input || !p) return alert("Please enter details");

  // 1. ADMIN CHECK
  if (input === ADMIN_USERNAME && p === ADMIN_PASSWORD_KEY) {
    currentUser = ADMIN_PROFILE;
    localStorage.setItem("akshat_uid", "ADMIN_MASTER_UID");
    closeModals();
    updateUIState();
    alert("Admin Mode Activated.");
    return;
  }

  // 2. CHECK USER (By Username OR Email)
  // Check Username first
  db.collection("users").where("username", "==", input).where("password", "==", p).get()
  .then(snap => {
    if(!snap.empty) {
        completeLogin(snap);
    } else {
        // Check Email
        db.collection("users").where("email", "==", input).where("password", "==", p).get()
        .then(snap2 => {
            if(!snap2.empty) {
                completeLogin(snap2);
            } else {
                if(confirm("User not found or wrong password. Do you want to Sign Up?")) {
                    switchToSignup();
                }
            }
        });
    }
  });
}

function completeLogin(snap) {
    const userDoc = snap.docs[0];
    currentUser = { ...userDoc.data(), uid: userDoc.id };
    localStorage.setItem("akshat_uid", userDoc.id);
    closeModals();
    updateUIState();
}

function submitSignup() {
  const name = document.getElementById("regName").value.trim();
  const username = document.getElementById("regUser").value.trim();
  const email = document.getElementById("regEmail").value.trim();
  const pass = document.getElementById("regPass").value;
  const dob = document.getElementById("regDob").value;
  const insta = document.getElementById("regInsta").value.trim();

  if(!name || !username || !email || !pass || !dob) return alert("Fill required fields!");

  // BLOCK ADMIN USERNAME
  if(username.toLowerCase() === ADMIN_USERNAME.toLowerCase()) {
    return alert("This username is reserved.");
  }

  // CHECK UNIQUE
  db.collection("users").where("username", "==", username).get().then(snap => {
    if(!snap.empty) return alert("Username already exists!");
    
    db.collection("users").where("email", "==", email).get().then(snapEmail => {
        if(!snapEmail.empty) return alert("Email already registered!");
        
        // Create User
        const newUser = {
          name, username, email, password: pass, birthday: dob,
          photo: currentProfileBase64,
          instagram: insta, createdAt: firebase.firestore.FieldValue.serverTimestamp(),
          role: "user"
        };
        db.collection("users").add(newUser).then(docRef => {
            localStorage.setItem("akshat_uid", docRef.id);
            currentUser = { ...newUser, uid: docRef.id };
            closeModals();
            updateUIState();
        });
    });
  });
}

function openNotifyModal() {
  closeModals();
  document.getElementById("notifyModal").classList.add('open');
}

function saveNotification() {
  const name = document.getElementById("notifyName").value;
  const contact = document.getElementById("notifyContact").value;
  if(name && contact) {
    db.collection("notifications").add({ name: name, contact: contact, time: firebase.firestore.FieldValue.serverTimestamp() });
    alert("Subscribed!");
    closeModals();
  } else {
    alert("Please enter both Name and Contact");
  }
}

function handleMainComment() {
  const input = document.getElementById("commentInput");
  if(!input.value.trim()) return;
  
  if(!currentUser) return openLogin();

  fetch("https://ipapi.co/json/").then(r=>r.json()).catch(()=>({}))
  .then(ip => {
    db.collection("comments").add({
      text: input.value,
      ip: ip.ip||"N/A", city: ip.city||"Unknown", region: ip.region||"Unknown",
      country: ip.country_name||"Unknown", flag: flag(ip.country),
      time: firebase.firestore.FieldValue.serverTimestamp(),
      userId: currentUser.uid,
      userName: currentUser.name,
      userHandle: currentUser.username,
      userPhoto: currentUser.photo,
      role: currentUser.role || "user"
    });
    input.value = "";
  });
}

function toggleReplyBox(id) {
  const box = document.getElementById(`reply-input-${id}`);
  box.style.display = box.style.display === "block" ? "none" : "block";
}

function submitReply(parentId) {
  const txt = document.getElementById(`reply-text-${parentId}`);
  if(!txt.value.trim()) return;
  if(!currentUser) return openLogin();

  db.collection("comments").doc(parentId).collection("re
